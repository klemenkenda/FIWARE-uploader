from time import sleep
from kafka import KafkaProducer
from json import dumps

producer = KafkaProducer(bootstrap_servers=['localhost:9092'],
                         value_serializer=lambda x:
                         dumps(x).encode('utf-8'))

topic = "predictions_braila_flow318505H498_prediction"
message = {
    "timestamp": 1665116422086,
    "value": [
        15.921018600463867, 16.0210018157959, 16.077255249023438, 16.002470016479492, 16.230113983154297, 17.545330047607422,
        19.255016326904297, 20.39081382751465, 21.269052505493164, 22.359413146972656, 24.176063537597656, 26.311756134033203,
        27.614147186279297, 27.5830135345459, 27.609088897705078, 27.603919982910156, 27.934715270996094, 28.73686408996582,
        29.351486206054688, 29.556926727294922, 29.5037841796875, 29.089000701904297, 29.50430679321289, 29.322925567626953,
        29.06045150756836, 28.789812088012695, 28.185365676879883, 27.545045852661133, 27.09507179260254, 26.468645095825195,
        25.739852905273438, 25.6151180267334, 25.758800506591797, 25.907794952392578, 26.395606994628906, 26.50414276123047,
        26.30116844177246, 26.41585922241211, 26.70631980895996, 27.34693145751953, 27.997406005859375, 28.46282196044922,
        29.046274185180664, 29.247888565063477, 29.444686889648438, 29.702896118164062, 30.35195541381836, 31.477283477783203,
        31.890140533447266, 31.700366973876953, 31.38302993774414, 30.60361099243164, 29.8697566986084, 29.483375549316406,
        28.901836395263672, 27.73402214050293, 26.553363800048828, 25.309995651245117, 23.665096282958984, 21.943601608276367,
        19.948566436767578, 18.186817169189453, 16.922607421875, 16.19572639465332, 15.691986083984375, 15.519247055053711,
        15.51774787902832, 15.615133285522461, 15.492074966430664, 15.584877014160156, 15.937671661376953, 16.065820693969727,
        15.993953704833984, 15.991086959838867, 16.061817169189453, 16.338397979736328, 16.506580352783203, 17.298715591430664,
        18.51972198486328, 19.13047981262207, 19.60133934020996, 20.05573844909668, 20.669483184814453, 22.439239501953125,
        24.273052215576172, 25.829463958740234, 27.15532684326172, 28.036632537841797, 28.6074161529541, 29.146541595458984,
        29.62099266052246, 29.29924964904785, 28.860750198364258, 28.326099395751953, 27.794631958007812, 27.466270446777344,
        27.00480842590332, 26.535409927368164, 26.676557540893555, 26.584257125854492, 26.200965881347656, 26.27100372314453,
        26.456693649291992, 26.312625885009766, 26.314170837402344, 26.059547424316406, 25.600313186645508, 25.512331008911133,
        25.578142166137695, 25.867204666137695, 26.462278366088867, 26.641498565673828, 27.320573806762695, 27.296438217163086,
        27.52509880065918, 27.353870391845703, 27.287511825561523, 27.118009567260742, 26.972654342651367, 26.737703323364258,
        26.976797103881836, 26.989770889282227, 26.48302459716797, 26.07767677307129, 25.824209213256836, 24.99346160888672,
        24.27171516418457, 23.758312225341797, 22.975217819213867, 22.123388290405273, 21.848974227905273, 20.572904586791992,
        19.23737907409668, 17.882654190063477, 16.9223690032959, 16.469449996948242, 16.081945419311523, 15.922218322753906,
        16.36967658996582, 16.527002334594727, 16.565534591674805, 16.32773208618164, 16.12737274169922, 15.99481201171875,
        15.875099182128906, 15.890312194824219, 16.06183433532715, 16.188648223876953, 16.400901794433594, 17.213363647460938,
        18.49644660949707, 19.234966278076172, 19.511425018310547, 19.87657928466797, 20.361286163330078, 21.056346893310547,
        22.013113021850586, 23.31574821472168, 24.44554901123047, 25.12067985534668, 26.136812210083008, 26.87491798400879,
        27.376182556152344, 27.340389251708984, 27.596010208129883, 27.28421401977539, 26.827987670898438, 26.36141586303711,
        26.097217559814453, 26.38300895690918, 26.56502342224121, 26.534221649169922, 26.60004425048828, 26.528810501098633,
        26.076833724975586, 25.93817138671875, 25.59010124206543, 24.637893676757812, 23.993921279907227, 23.5768985748291,
        23.81064224243164, 24.791229248046875, 25.021425247192383, 24.951566696166992, 24.56451416015625, 24.680191040039062,
        24.670625686645508, 24.820600509643555, 25.018388748168945, 25.473966598510742, 25.629758834838867, 26.792936325073242,
        27.368574142456055, 27.4439697265625, 27.91446304321289, 28.459346771240234, 28.077497482299805, 27.43489646911621,
        26.302215576171875, 25.287551879882812, 24.175195693969727, 23.61722755432129, 22.371788024902344, 20.34256935119629,
        18.06550407409668, 16.0103816986084, 14.935628890991211, 14.204371452331543, 13.96381664276123, 14.10951042175293,
        14.432510375976562, 14.685774803161621, 15.373760223388672, 16.071243286132812, 16.08214569091797, 15.818368911743164,
        15.464639663696289, 15.339855194091797, 15.382810592651367, 15.905254364013672, 16.557064056396484, 17.903623580932617,
        19.737728118896484, 21.002769470214844, 22.173786163330078, 23.517179489135742, 25.168319702148438, 27.398258209228516,
        28.623676300048828, 28.806529998779297, 28.655622482299805, 28.53750228881836, 28.4117431640625, 28.81887435913086,
        29.362810134887695, 29.251798629760742, 28.932525634765625, 28.231882095336914, 28.14742660522461, 27.897228240966797,
        27.000646591186523, 26.374347686767578, 25.90284538269043, 25.98309326171875, 25.606386184692383, 25.258541107177734,
        24.833721160888672, 23.737375259399414, 22.952045440673828, 22.581087112426758, 22.55010986328125, 22.83837127685547,
        23.077804565429688, 22.943634033203125, 23.136985778808594, 23.699783325195312, 23.846027374267578, 24.519176483154297,
        24.83188819885254, 25.95205307006836, 26.94639015197754, 27.14422607421875, 27.23691177368164, 27.594532012939453,
        27.73289680480957, 27.965057373046875, 27.98765754699707, 28.179384231567383, 27.476459503173828, 26.49471092224121,
        25.736644744873047, 24.514719009399414, 23.016555786132812, 21.615875244140625, 20.501590728759766, 18.78041648864746,
        16.973281860351562, 15.638616561889648, 14.999969482421875, 14.783706665039062, 14.697330474853516, 14.850170135498047,
        14.905519485473633, 14.969972610473633, 15.068037986755371, 15.263301849365234, 15.34597396850586, 15.399185180664062,
        15.472539901733398, 15.458404541015625, 15.576700210571289, 15.76266098022461, 15.95273208618164, 16.99390411376953,
        18.494155883789062, 19.442689895629883, 20.342044830322266, 21.668060302734375, 23.39878273010254, 25.266178131103516,
        26.916141510009766, 27.357662200927734, 26.798263549804688, 26.851726531982422, 26.976322174072266, 26.8245906829834,
        27.212907791137695, 27.070838928222656, 26.43983268737793, 26.234161376953125, 25.961971282958984, 25.506383895874023,
        25.65502166748047, 25.452062606811523, 25.212697982788086, 25.212312698364258, 24.933185577392578, 24.586530685424805,
        23.861642837524414, 23.332746505737305, 22.875566482543945, 22.61848258972168, 23.25885009765625, 23.626815795898438,
        23.754688262939453, 23.376625061035156, 23.561548233032227, 23.799203872680664, 24.53940200805664, 25.457530975341797,
        25.971384048461914, 25.931228637695312, 26.851036071777344, 27.937461853027344, 27.968059539794922, 28.21579360961914,
        27.946762084960938, 27.46578025817871, 26.909496307373047, 26.622386932373047, 26.00260353088379, 25.190580368041992,
        24.30244255065918, 23.706565856933594, 22.681137084960938, 21.629243850708008, 20.598358154296875, 19.198972702026367,
        17.70700454711914, 16.38574981689453, 15.53255844116211, 14.883831024169922, 14.415903091430664, 14.304790496826172,
        14.375713348388672, 14.532343864440918, 14.74459457397461, 14.877853393554688, 15.050555229187012, 15.102828979492188,
        15.08064079284668, 15.086384773254395, 15.109979629516602, 15.260614395141602, 15.877044677734375, 17.13960838317871,
        18.769977569580078, 19.633678436279297, 20.38759994506836, 21.218496322631836, 22.067434310913086, 23.075178146362305,
        24.331256866455078, 25.07452964782715, 25.243406295776367, 26.187349319458008, 26.65521240234375, 27.186504364013672,
        27.57945442199707, 27.4940242767334, 27.830331802368164, 27.652965545654297, 28.04136848449707, 27.838848114013672,
        27.44985008239746, 26.774946212768555, 26.297666549682617, 26.27322006225586, 26.2961368560791, 26.62176513671875, 14.805581092834473, 14.7698974609375, 14.66533088684082, 14.58426570892334, 14.590864181518555, 14.884852409362793, 15.313316345214844, 15.645713806152344, 16.627201080322266, 18.097986221313477, 19.280323028564453, 20.41166114807129, 21.600412368774414, 23.091264724731445, 25.350177764892578, 26.707965850830078, 26.65097999572754, 26.407033920288086, 26.610979080200195, 26.73016929626465, 26.80996322631836, 26.728023529052734, 27.23474884033203, 27.107162475585938, 26.819833755493164, 25.922199249267578, 25.777292251586914, 24.877206802368164, 24.012367248535156, 24.189605712890625, 25.07301902770996, 25.554969787597656, 25.590177536010742, 26.88665199279785, 26.038591384887695, 25.037473678588867, 24.436647415161133, 23.421194076538086, 22.310741424560547, 20.885406494140625, 19.38142204284668, 18.131624221801758, 17.2280216217041, 16.516693115234375, 15.930681228637695, 15.42026138305664, 15.126266479492188, 15.123682022094727, 14.975765228271484, 15.116887092590332, 15.353273391723633, 15.331069946289062, 15.383787155151367, 15.474483489990234, 15.658895492553711, 15.765518188476562, 15.942743301391602, 16.016592025756836, 16.20009994506836, 17.32929801940918, 21.39251708984375, 24.77376365661621, 26.853376388549805, 28.28989601135254, 29.99585723876953, 31.134435653686523, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0
    ],
    "prediction_time": 1665128415.3967307}

print(len(message["value"]))

for i in range(1):
    print(i)
    producer.send(topic, value=message)
    sleep(10)